<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PHCM9795: Foundations of Biostatistics - 1 An introduction to R and RStudio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01.3-intro-activities.html" rel="next">
<link href="./01.1-intro-stata.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><strong>1</strong> An introduction to R and RStudio</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PHCM9795: Foundations of Biostatistics</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to statistics and presenting data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.1-intro-stata.html" class="sidebar-item-text sidebar-link"><strong>1</strong> An introduction to Stata</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.2-intro-R.html" class="sidebar-item-text sidebar-link active"><strong>1</strong> An introduction to R and RStudio</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.3-intro-activities.html" class="sidebar-item-text sidebar-link"><strong>1</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability and probability distributions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.1-probability-stata.html" class="sidebar-item-text sidebar-link"><strong>2</strong> Stata notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.2-probability-R.html" class="sidebar-item-text sidebar-link"><strong>2</strong> R notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.3-probability-activities.html" class="sidebar-item-text sidebar-link"><strong>2</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-precision.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Precision, standard errors and confidence intervals</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.1-precision-stata.html" class="sidebar-item-text sidebar-link"><strong>3</strong> Stata notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.2-precision-R.html" class="sidebar-item-text sidebar-link"><strong>3</strong> R notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.3-precision-activities.html" class="sidebar-item-text sidebar-link"><strong>3</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-hypothesis-testing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.1-hypothesis-testing-stata.html" class="sidebar-item-text sidebar-link"><strong>4</strong> Stata notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.2-hypothesis-testing-R.html" class="sidebar-item-text sidebar-link"><strong>4</strong> R notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.3-hypothesis-testing-activities.html" class="sidebar-item-text sidebar-link"><strong>4</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-comparing-two-means.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Comparing the means of two groups</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.1-comparing-two-means-stata.html" class="sidebar-item-text sidebar-link"><strong>5</strong> Stata notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.2-comparing-two-means-R.html" class="sidebar-item-text sidebar-link"><strong>5</strong> R notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.3-comparing-two-means-activities.html" class="sidebar-item-text sidebar-link"><strong>5</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-proportions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Summary statistics for binary data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.1-proportions-stata.html" class="sidebar-item-text sidebar-link"><strong>6</strong> Stata notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.2-proportions-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary statistics for binary data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.3-proportions-activities.html" class="sidebar-item-text sidebar-link"><strong>6</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-testing-proportions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hypothesis testing for categorical data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-correlation-and-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Correlation and linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.1-correlation-and-regression-stata.html" class="sidebar-item-text sidebar-link"><strong>8</strong> Stata notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.2-correlation-and-regression-R.html" class="sidebar-item-text sidebar-link"><strong>8</strong> R notes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.3-correlation-and-regression-activities.html" class="sidebar-item-text sidebar-link"><strong>8</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-non-parametrics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Analysing non-normal data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.1-non-parametrics-stata.html" class="sidebar-item-text sidebar-link"><strong>9</strong> Stata resources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.2-non-parametrics-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Analysing non-normal data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.3-non-parametrics-activities.html" class="sidebar-item-text sidebar-link"><strong>9</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-sample-size.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Sample size estimation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.1-sample-size-stata.html" class="sidebar-item-text sidebar-link"><strong>10</strong> Stata resources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.2-sample-size-R.html" class="sidebar-item-text sidebar-link"><strong>10</strong> R resources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.3-sample-size-activities.html" class="sidebar-item-text sidebar-link"><strong>10</strong> Learning Activities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-outcomes" id="toc-learning-outcomes" class="nav-link active" data-scroll-target="#learning-outcomes">Learning outcomes</a></li>
  <li><a href="#part-1-an-introduction-to-r" id="toc-part-1-an-introduction-to-r" class="nav-link" data-scroll-target="#part-1-an-introduction-to-r">Part 1: An introduction to R</a></li>
  <li><a href="#r-vs-rstudio" id="toc-r-vs-rstudio" class="nav-link" data-scroll-target="#r-vs-rstudio">R vs RStudio</a></li>
  <li><a href="#installing-r-and-rstudio" id="toc-installing-r-and-rstudio" class="nav-link" data-scroll-target="#installing-r-and-rstudio">Installing R and RStudio</a>
  <ul class="collapse">
  <li><a href="#to-install-r-on-your-computer" id="toc-to-install-r-on-your-computer" class="nav-link" data-scroll-target="#to-install-r-on-your-computer">To install R on your computer</a></li>
  <li><a href="#to-install-rstudio-on-your-computer" id="toc-to-install-rstudio-on-your-computer" class="nav-link" data-scroll-target="#to-install-rstudio-on-your-computer">To install RStudio on your computer</a></li>
  </ul></li>
  <li><a href="#recommended-setup" id="toc-recommended-setup" class="nav-link" data-scroll-target="#recommended-setup">Recommended setup</a>
  <ul class="collapse">
  <li><a href="#rstudio-preferences" id="toc-rstudio-preferences" class="nav-link" data-scroll-target="#rstudio-preferences">RStudio preferences</a></li>
  <li><a href="#set-up-a-project" id="toc-set-up-a-project" class="nav-link" data-scroll-target="#set-up-a-project">Set up a project</a></li>
  </ul></li>
  <li><a href="#simpleR" id="toc-simpleR" class="nav-link" data-scroll-target="#simpleR">A simple R analysis</a></li>
  <li><a href="#the-rstudio-environment" id="toc-the-rstudio-environment" class="nav-link" data-scroll-target="#the-rstudio-environment">The RStudio environment</a></li>
  <li><a href="#some-r-basics" id="toc-some-r-basics" class="nav-link" data-scroll-target="#some-r-basics">Some R basics</a>
  <ul class="collapse">
  <li><a href="#scripts" id="toc-scripts" class="nav-link" data-scroll-target="#scripts">Scripts</a></li>
  <li><a href="#objects" id="toc-objects" class="nav-link" data-scroll-target="#objects">Objects</a></li>
  <li><a href="#data-structures" id="toc-data-structures" class="nav-link" data-scroll-target="#data-structures">Data structures</a></li>
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#how-to-install-a-package" id="toc-how-to-install-a-package" class="nav-link" data-scroll-target="#how-to-install-a-package">How to install a package</a></li>
  <li><a href="#how-to-load-a-package" id="toc-how-to-load-a-package" class="nav-link" data-scroll-target="#how-to-load-a-package">How to load a package</a></li>
  </ul></li>
  <li><a href="#what-is-this-thing-called-the-tidyverse" id="toc-what-is-this-thing-called-the-tidyverse" class="nav-link" data-scroll-target="#what-is-this-thing-called-the-tidyverse">What is this thing called the tidyverse?</a></li>
  <li><a href="#part-2-obtaining-basic-descriptive-statistics" id="toc-part-2-obtaining-basic-descriptive-statistics" class="nav-link" data-scroll-target="#part-2-obtaining-basic-descriptive-statistics">Part 2: Obtaining basic descriptive statistics</a></li>
  <li><a href="#set-up-your-data" id="toc-set-up-your-data" class="nav-link" data-scroll-target="#set-up-your-data">Set up your data</a></li>
  <li><a href="#reading-a-data-file" id="toc-reading-a-data-file" class="nav-link" data-scroll-target="#reading-a-data-file">Reading a data file</a></li>
  <li><a href="#summarising-continuous-variables" id="toc-summarising-continuous-variables" class="nav-link" data-scroll-target="#summarising-continuous-variables">Summarising continuous variables</a></li>
  <li><a href="#producing-a-histogram" id="toc-producing-a-histogram" class="nav-link" data-scroll-target="#producing-a-histogram">Producing a histogram</a></li>
  <li><a href="#producing-a-boxplot" id="toc-producing-a-boxplot" class="nav-link" data-scroll-target="#producing-a-boxplot">Producing a boxplot</a></li>
  <li><a href="#producing-a-one-way-frequency-table" id="toc-producing-a-one-way-frequency-table" class="nav-link" data-scroll-target="#producing-a-one-way-frequency-table">Producing a one-way frequency table</a>
  <ul class="collapse">
  <li><a href="#defining-categorical-variables-as-factors" id="toc-defining-categorical-variables-as-factors" class="nav-link" data-scroll-target="#defining-categorical-variables-as-factors">Defining categorical variables as factors</a></li>
  </ul></li>
  <li><a href="#producing-a-two-way-frequency-table" id="toc-producing-a-two-way-frequency-table" class="nav-link" data-scroll-target="#producing-a-two-way-frequency-table">Producing a two-way frequency table</a></li>
  <li><a href="#saving-data-in-r" id="toc-saving-data-in-r" class="nav-link" data-scroll-target="#saving-data-in-r">Saving data in R</a></li>
  <li><a href="#copying-output-from-r" id="toc-copying-output-from-r" class="nav-link" data-scroll-target="#copying-output-from-r">Copying output from R</a></li>
  <li><a href="#part-3-creating-other-types-of-graphs" id="toc-part-3-creating-other-types-of-graphs" class="nav-link" data-scroll-target="#part-3-creating-other-types-of-graphs">Part 3: Creating other types of graphs</a></li>
  <li><a href="#bar-graphs" id="toc-bar-graphs" class="nav-link" data-scroll-target="#bar-graphs">Bar graphs</a>
  <ul class="collapse">
  <li><a href="#clustered-bar-graph" id="toc-clustered-bar-graph" class="nav-link" data-scroll-target="#clustered-bar-graph">Clustered bar graph</a></li>
  <li><a href="#stacked-bar-graph" id="toc-stacked-bar-graph" class="nav-link" data-scroll-target="#stacked-bar-graph">Stacked bar graph</a></li>
  <li><a href="#stacked-bar-graph-of-relative-frequencies" id="toc-stacked-bar-graph-of-relative-frequencies" class="nav-link" data-scroll-target="#stacked-bar-graph-of-relative-frequencies">Stacked bar graph of relative frequencies</a></li>
  </ul></li>
  <li><a href="#creating-line-graphs" id="toc-creating-line-graphs" class="nav-link" data-scroll-target="#creating-line-graphs">Creating line graphs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><strong>1</strong> An introduction to R and RStudio</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="learning-outcomes" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-outcomes">Learning outcomes</h2>
<p>By the end of this Module, you will be able to:</p>
<ul>
<li>understand the difference between R and RStudio</li>
<li>navigate the RStudio interface</li>
<li>input and import data into R</li>
<li>use R to summarise data</li>
<li>perform basic data transformations</li>
<li>understand the difference between saving R data and saving R output</li>
<li>copy R output to a standard word processing package</li>
</ul>
</section>
<section id="part-1-an-introduction-to-r" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="part-1-an-introduction-to-r">Part 1: An introduction to R</h2>
<p>“R is a language and environment for statistical computing and graphics.” <a href="https://www.r-project.org/about.html">Link</a>. It is an open-source programming language, used mainly for statistics (including biostatistics) and data science.</p>
<p>The aim of these notes is to introduce the R language within the RStudio environment, and to introduce the commands and procedures that are directly relevant to this course. There is so much more to R than we can cover in these notes. Relevant information will be provided throughout the course, and we will provide further references that you can explore if you are interested.</p>
</section>
<section id="r-vs-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="r-vs-rstudio">R vs RStudio</h2>
<p>At its heart, R is a programming language. When you install R on your computer, you are installing the language and its resources, as well as a very basic interface for using R. You can write and run R code using the basic R app, but it’s not recommended.</p>
<p>RStudio is an “Integrated Development Environment” that runs R while also providing useful tools to help you write code and analyse data. You can think of R as an engine which does the work, and RStudio as a car that uses the engine, but also provides useful tools like GPS navigation and reversing cameras that help you drive.</p>
<p>Note: even though we recommend that you use RStudio, you still need install R. <strong>RStudio will not run without R installed.</strong></p>
<table class="table">
<colgroup>
<col style="width: 44%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">R: Don’t run this</th>
<th style="text-align: center;">RStudio: Run this instead</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="img/mod01/Rlogo.png" alt="R logo" style="height: 100px;"></td>
<td style="text-align: center;"><img src="img/mod01/RStudio-logo-flat.png" alt="RStudio logo" style="height: 100px;"></td>
</tr>
</tbody>
</table>
</section>
<section id="installing-r-and-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="installing-r-and-rstudio">Installing R and RStudio</h2>
<section id="to-install-r-on-your-computer" class="level3">
<h3 class="anchored" data-anchor-id="to-install-r-on-your-computer">To install R on your computer</h3>
<ol type="1">
<li><p>Download the R installer from:</p>
<ol type="a">
<li>for Windows: <a href="https://cran.r-project.org/bin/windows/base/" class="uri">https://cran.r-project.org/bin/windows/base/</a></li>
<li>for MacOS: <a href="https://cran.r-project.org/bin/macosx/" class="uri">https://cran.r-project.org/bin/macosx/</a></li>
</ol>
<ul>
<li><strong>Note for Windows users:</strong> as at May 27, 2022, R Version 4.2.0 has compatability issues with RStudio. You should download and install R from <a href="https://cran.r-project.org/bin/windows/base/rpatched.html" class="uri">https://cran.r-project.org/bin/windows/base/rpatched.html</a></li>
</ul></li>
<li><p>Install R by running the installer and following the installation instructions. The default settings are fine.</p>
<ul>
<li><strong>Note for macOS:</strong> if you are running macOS 10.8 or later, you will need to install an additional application called XQuartz, which is available at <a href="https://www.xquartz.org/" class="uri">https://www.xquartz.org/</a>. Download the latest installer (XQuartz-2.8.1.dmg as of April 2022), and install it in the usual way.</li>
</ul></li>
<li><p>Open the R program. You should see a screen as below:</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/R-screenshot.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>Near the bottom of the R screen, you will find the “&gt;” symbol which represents the command line. If you type <code>1 + 2</code> into the command line and then hit enter you should get:</p>
<p><code>[1] 3</code></p>
<p>This is R performing your calculation, with the <code>[1]</code> indicating that the solution to <code>1 + 2</code> is a single number (the number 3).</p>
<p>At this point, close R - we will not interact with R like this in the future. You can close R by typing <code>quit()</code> at the command prompt, followed by the return key, or in the usual way of closing an application in your operating system. There is no need to save anything here if prompted.</p>
</section>
<section id="to-install-rstudio-on-your-computer" class="level3">
<h3 class="anchored" data-anchor-id="to-install-rstudio-on-your-computer">To install RStudio on your computer</h3>
<ol type="1">
<li>Make sure you have already installed R, and verified that it is working.</li>
<li>Download the RStudio desktop installer at: <a href="https://www.rstudio.com/products/rstudio/download" class="uri">https://www.rstudio.com/products/rstudio/download</a>. Ensure that you select the RStudio Desktop (Free) installer in the first column.</li>
<li>Install RStudio by running the installer and following the installation instructions. The default settings are fine.</li>
<li>Open RStudio, which will appear as below:</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/RStudio-screenshot-01.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Locate the command line symbol “&gt;” at the bottom of the left-hand panel. Type <code>1 + 2</code> into the command line and hit enter, and you will see:</p>
<p><code>[1] 3</code></p>
<p>This confirms that RStudio is running correctly, and can use the R language to correctly calculate the sum between 1 and 2!</p>
<p>RStudio currently comprises three window panes, and we will discuss these later.</p>
</section>
</section>
<section id="recommended-setup" class="level2">
<h2 class="anchored" data-anchor-id="recommended-setup">Recommended setup</h2>
<p>I will provide a recommended setup for R and RStudio in this section. You are free to use alternative workflows and setup, but this setup works well in practice.</p>
<section id="rstudio-preferences" class="level3">
<h3 class="anchored" data-anchor-id="rstudio-preferences">RStudio preferences</h3>
<p>By default, RStudio will retain data, scripts and other objects when you quit your RStudio session. Relying on this can cause headaches, so I recommend that you set up RStudio so that it does not preserve your workspace between sessions. Open the RStudio options:</p>
<ul>
<li><p>Mac: <strong>RStudio &gt; Preferences</strong></p></li>
<li><p>Windows: <strong>Tools &gt; Options</strong></p></li>
</ul>
<p>and <strong>deselect “Restore .RData into workplace at startup”</strong>, and choose: “<strong>Save workspace to .RData on exit:</strong> <strong>Never”</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/RStudio-preferences.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
</section>
<section id="set-up-a-project" class="level3">
<h3 class="anchored" data-anchor-id="set-up-a-project">Set up a project</h3>
<p>A project in RStudio is a folder that RStudio recognises as a place to store R scripts, data files, figures that are common to an analysis project. Setting up a folder allows much more simple navigation and specification of data files and output. More detail can be found in Chapter 8 of the excellent text: <a href="https://r4ds.had.co.nz/workflow-projects.html">R for Data Science</a>. Using projects is not necessary, but I recommend working with projects from day one.</p>
<p>We will create a project called <strong>PHCM9795</strong> to store all the data you will use and scripts that you will write in this course. First, think about where you want to store your project folder: this could be somewhere in your <em>Documents</em> folder.</p>
<p>Step 1: Choose <strong>File &gt; New Project…</strong> in RStudio to open the <strong>Create Project</strong> dialog box:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/NewProject-1.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>Step 2: Click the first option to create a project in a <strong>New directory</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/NewProject-2.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>Step 3: Click the first option: <strong>New Project</strong>. Give the project a name, by typing PHCM9795 in the “Directory name”, and choose where you want to store the project by clicking the <strong>Browse</strong> button.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/NewProject-3.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>Step 4: Click <strong>Create</strong> to create your project.</p>
<p>You will now have a new folder in your directory, which contains only one file: PHCM9795.Rproj, and the two right-hand panes of RStudio will appear as below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/NewProject-4.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>The top-right menu bar is showing that you are working within the PHCM9795 project, and the bottom-right window is showing the contents of that window: the single PHCM9795.Rproj file. We will add some more files to this project later.</p>
</section>
</section>
<section id="simpleR" class="level2">
<h2 class="anchored" data-anchor-id="simpleR">A simple R analysis</h2>
<p>In this very brief section, we will introduce R by calculating the average of six ages.</p>
<p>To begin, open a new R Script by choosing <strong>File &gt; New file &gt; R Script</strong> . A script (or a program) is a collection of commands that are sequentially processed by R. You can also type Ctrl+Shift+N in Windows, or Command+Shift+N in MacOS to open a new script in RStudio, or click the <strong>New File</strong> button at the top of the RStudio window.</p>
<p>You should now see four window panes, as below. In the top-left window, type the following (replacing my name with yours, and including today’s date):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: Timothy Dobbins</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Date: 5 April 2022</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Purpose: My first R script</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">27</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Note: R is case-sensitive</strong>, so you should enter the text exactly as written in these notes.</p>
<p>Your screen should look something like:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/RStudio-screenshot-02.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>To run your script, choose <strong>Code &gt; Run Region &gt; Run All</strong>. You will see your code appear in the bottom-left window, with the following output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Author: Timothy Dobbins</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Date: 5 April 2022</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Purpose: My first R script</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">27</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(age)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">20.00</span>   <span class="fl">21.50</span>   <span class="fl">24.00</span>   <span class="fl">24.17</span>   <span class="fl">26.50</span>   <span class="fl">29.00</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will explain the key parts of this script later, but for now, you have entered six ages and calculated the mean age (along with five other summary statistics).</p>
<p>Save your script within the PHCM9795 project by using <strong>File &gt; Save As</strong>, using the name <code>my_first_analysis.R</code>.</p>
</section>
<section id="the-rstudio-environment" class="level2">
<h2 class="anchored" data-anchor-id="the-rstudio-environment">The RStudio environment</h2>
<p>Now that we have seen a simple example of how to use R within RStudio, let’s describe the RStudio environment. Let’s assume that you have just run your first R script, and you have four windows as below:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/RStudio-screenshot-03.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The top-left window is call the <strong>Source</strong> window, and is where you write and edit your R scripts. Scripts can be saved by clicking <strong>File &gt; Save As</strong> or by clicking on the symbol of a floppy disk at the top of the script. The file will have an extension of .R, for example script.R. Remember to give your script a meaningful title and remember to periodically save as you go.</p>
<p>In RStudio, the name of the script will be black when it has been saved, and will change to red if you have any unsaved changes.</p>
<p>The <strong>Console</strong> window, at the bottom left, contains the command line which is indicated with the symbol &gt;. You can type commands here, but anything executed directly from the console is not saved and therefore is lost when the session ends (when you exit RStudio). You should always run your commands from a script file which you can save and use again later. When you run commands from a script, the output and any notes/errors are shown in the console. The Terminal and Jobs tabs will not be used in this course.</p>
<p>The <strong>Environment</strong> window at the top-right shows a list of objects that have been created during your session. When you close your RStudio session these objects will disappear. We will not use the History or Connections tabs in this course.</p>
<p>The bottom right corner contains some useful tabs, in particular the <strong>Help</strong> tab. When you are troubleshooting errors or learning how to use a function, the Help tab should be the first place you visit. Here you can search the help documents for all the packages you have installed. Whenever you create plots in R, these will be shown in the <strong>Plots</strong> tab. The <strong>Packages</strong> tab contains a list of installed packages and indicates which ones are currently in use (we will learn about packages later). Packages which are loaded, i.e.&nbsp;in use, are indicated with a tick. Some packages are in use by default when you begin a new session. You can access information about a package by clicking on its name. The <strong>Files</strong> tab provides a shortcut to access your files. The Viewer tab will not be used in this course.</p>
</section>
<section id="some-r-basics" class="level2">
<h2 class="anchored" data-anchor-id="some-r-basics">Some R basics</h2>
<p>While we use R as a statistics package, R is a programming language. In order to use R effectively, we need to define some basics.</p>
<section id="scripts" class="level3">
<h3 class="anchored" data-anchor-id="scripts">Scripts</h3>
<p>While R can be run completely from the command line, issuing commands one-by-one, it is most commonly run using <strong>scripts</strong>. A script is simply a list of commands that are processed in order. The simple analysis we conducted earlier is a very simple script. Some things to know about R scripts:</p>
<ul>
<li><p>anything appearing after a # is a comment, and is ignored by R. The first three lines of our script are there for ourselves (either as writers of code, or readers of code). I include comments at the beginning of each of my scripts to describe:</p>
<ul>
<li><p>who wrote the script (useful if someone else uses your script and wants to ask questions about it);</p></li>
<li><p>when the script was written;</p></li>
<li><p>what the script does. This last point may seem odd, but it’s useful to describe what this script does, and why it might differ to other scripts being used in the analysis. This is particularly useful if your scripts become long and complex.</p></li>
</ul></li>
<li><p><strong>R is case-sensitive</strong>. So <code>age</code>, <code>AGE</code> and <code>Age</code> could refer to three separate variables (please don’t do this!)</p></li>
<li><p>use blank lines and comments to separate sections of your script</p></li>
</ul>
</section>
<section id="objects" class="level3">
<h3 class="anchored" data-anchor-id="objects">Objects</h3>
<p>If you do some reading about R, you may learn that R is an “object-oriented programming language”. When we enter or import data into R, we are asking R to create <strong>objects</strong> from our data. These objects can be manipulated and transformed by <strong>functions</strong>, to obtain useful insights from our data.</p>
<p>Objects in R are created using the <strong>assignment operator</strong>. The most common form of the assignment operator looks like an arrow: <code>&lt;-</code> and is typed as the <code>&lt;</code> and <code>-</code> symbols. The simplest way of reading <code>&lt;-</code> is as the words “is defined as”. Note that it possible to use <code>-&gt;</code> and even <code>=</code> as assignment operators, but their use is less frequent.</p>
<p>Let’s see an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">42</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This command creates a new object called <code>x</code>, which is defined as the number 42 (or in words, “<code>x</code> is defined as 42”). Running this command gives no output in the console, but the new object appears in the top-right <strong>Environment</strong> panel. We can view the object in the console by typing its name:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the object x</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 42</code></pre>
</div>
</div>
<p>Now we see the contents of <code>x</code> in the console.</p>
<p>This example is rather trivial, and we rarely assign objects of just one value. In fact, we created an object earlier, called <code>age</code>, which comprised six values.</p>
</section>
<section id="data-structures" class="level3">
<h3 class="anchored" data-anchor-id="data-structures">Data structures</h3>
<p>There are two main structures we will use to work with data in this course: <strong>vectors</strong> and <strong>data frames</strong>. A <strong>vector</strong> is a combination of data values, all of the same type. For example, our six ages that we entered earlier is a vector. You could think of a vector as a column of data (even though R prints vectors as rows!) And technically, even an object with only one value is a vector, a vector of size 1.</p>
<p>The easiest way of creating a vector in R is by using the <code>c()</code> function, where c stands for ‘combine’. In our previous Simple Analysis in R (Section @ref(simpleR)), we wrote the command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">27</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This command created a new object called <code>age</code>, and <em>combined</em> the six values of age into one vector.</p>
<p>Just as having a vector of size 1 is unusual, having just one column of data to analyse is also pretty unusual. The other structure we will describe here is a <strong>data frame</strong> which is essentially a collection of vectors, each of the same size. You could think of a data frame as being like a spreadsheet, with columns representing variables, and rows representing observations.</p>
<p>There are other structures in R, such as matrices and lists, which we won’t discuss in this course. And you may come across the term <strong>tibble</strong>, which is a type of data frame.</p>
</section>
<section id="functions" class="level3">
<h3 class="anchored" data-anchor-id="functions">Functions</h3>
<p>If objects are the nouns of R, functions are the verbs. Essentially, functions transform objects. Functions can transform your data into summary statistics, graphical summaries or analysis results. For example, we used the <code>summary()</code> function to display summary statistics for our six ages.</p>
<p>R functions are specified by their arguments (or inputs). The arguments that can be supplied for each function can be inspected by examining the help notes for that function. To obtain help for a function, we can submit <code>help(summary)</code> (or equivalently <code>?summary</code>) in the console, or we can use the <strong>Help</strong> tab in the bottom-right window of RStudio. For example, the first part of the help notes for <code>summary</code> appear as:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/help-1.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>The help notes in R can be quite cryptic, but the <strong>Usage</strong> section details what inputs should be specified for the function to run. Here, <code>summary</code> requires an object to be specified. In our case, we specified <code>age</code>, which is our object defined as the vector of six ages.</p>
<p>Most help pages also include some examples of how you might use the function. These can be found at the very bottom of the help page.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/help-2.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>The <code>summary()</code> function is quite simple, in that it only requires one input, the object to be summarised. More complex functions might require a number of inputs. For example, the help notes for the <code>descriptives()</code> function in the <code>jmv</code> package show a large number of inputs can be specified:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/help-3.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>There are two things to note here. First, notice that the first two inputs are listed with no = symbol, but all other inputs are listed with = symbols (with values provided after the = symbol). This means that everything apart from <code>data</code> and <code>vars</code> have <strong>default</strong> values. We are free to not specify values for these inputs if we are happy with the defaults provided. For example, by default the variance is not calculated (as <code>variance = FALSE</code>). To obtain the variance as well as the standard deviation, we can change this default to <code>variance = TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only the standard deviation is provided as the measure of variability</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>pbc, <span class="at">vars=</span>age)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Additionally request the variance to be calculated</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>pbc, <span class="at">vars=</span>age, <span class="at">variance=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Second, for functions with multiple inputs, we can specify the input name and its value, or we can ignore the input name and specify just the input values <strong>in the order listed in the Usage section</strong>. So the following are equivalent:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can specify that the dataset to be summarised is pbc,</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   and the variable to summarise is age:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>pbc, <span class="at">vars=</span>age)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We can omit the input name, as long as we keep the inputs in the correct order - </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   that is, dataset first, variable second:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(pbc, age)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We can change the order of the inputs, as long as we specify the input name:</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">vars=</span>age, <span class="at">data=</span>pbc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this course, we will usually provide all the input names, even when they are not required. As you become more familiar with R, you will start to use the shortcut method.</p>
<section id="the-curse-of-inconsistency" class="level4">
<h4 class="anchored" data-anchor-id="the-curse-of-inconsistency">The curse of inconsistency</h4>
<p>As R is an open-source project, many people have contributed to its development. This has led to a frustrating part of R: some functions require a single object to be specified, but some require you to specify a data frame and select variables for analysis. Let’s see an example.</p>
<p>The help for <code>summary()</code> specifies the usage as: <code>summary(object, ...)</code>. This means we need to specify a single object to be summarised. An object could be a single column of data (i.e.&nbsp;a vector), or it could be a data frame. If we have a data frame called <code>pbc</code> which contains many variables, the command <code>summary(pbc)</code> would summarise every variable in the data frame.</p>
<p>What if we only wanted to summarise the age of the participants in the data frame? To select a single variable from a data frame, we can use the following syntax: <code>dataframe$variable</code>. So to summarise just age from this data frame, we would use: <code>summary(pbc$age)</code>.</p>
<p>Compare this with the <code>descriptives()</code> function in the <code>jmv</code> package. We saw earlier that the two required inputs for <code>descriptives()</code> are <code>data</code> (the data frame to be analysed) and <code>vars</code> (the variables to be analysed). So to summarise <code>age</code> from the <code>pbc</code> data frame, we would specify <code>descriptives(data=pbc, vars=age)</code>.</p>
<p>This inconsistency will seem maddening at first, and will continue to be maddening! Reading the <strong>usage</strong> section of the help pages is a useful way to determine whether you should specify an object (like <code>pbc$age</code>) or a data frame and a list of variables.</p>
</section>
</section>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<p>A <strong>package</strong> is a collection of functions, documentation (and sometimes datasets) that extend the capabilities of R. Packages have been written by R users to be freely distributed and used by others. R packages can be obtained from many sources, but the most common source is CRAN: the Comprehensive R Archive Network.</p>
<p>A useful way of thinking about R is that R is like a smartphone, with packages being like apps which are downloaded from CRAN (similar to an app-store). When you first install R, it comes with a basic set of packages (apps) installed. You can do a lot of things with these basic packages, but sometimes you might want to do things differently, or you may want to perform some analyses that can’t be done using the default packages. In these cases, you can install a package.</p>
<p>Like installing an app on a smartphone, you only need to <em>install</em> a package once. But each time you want to use the package, you need to <em>load</em> the package into R.</p>
</section>
<section id="how-to-install-a-package" class="level3">
<h3 class="anchored" data-anchor-id="how-to-install-a-package">How to install a package</h3>
<p>There are a couple of ways to install a package. You can use the <code>install.packages()</code> function if you know the exact name of the package. Let’s use an example of installing the <code>skimr</code> package, which gives a very nice, high-level overview of any data frame. We can install <code>skimr</code> by typing the following into the console:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"skimr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note the use of the quotation marks.</p>
<p>Alternatively, RStudio offers a graphical way of installing packages that can be accessed via <strong>Tools &gt; Install Packages</strong>, or via the <strong>Install</strong> button at the top of the <strong>Packages</strong> tab in the bottom-right window. You can begin typing the name of the package in the dialog box that appears, and RStudio will use predictive text to offer possible packages:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/install-packages.png" class="img-fluid" style="width:60.0%"></p>
</div>
</div>
<p>While writing code is usually the recommended way to use R, installing packages is an exception. Using <strong>Tools &gt; Install Packages</strong> is perfectly fine, because you only need to install a package once.</p>
</section>
<section id="how-to-load-a-package" class="level3">
<h3 class="anchored" data-anchor-id="how-to-load-a-package">How to load a package</h3>
<p>When you begin a new session in RStudio, i.e.&nbsp;when you open RStudio, only certain core packages are automatically loaded. You can use the <code>library()</code> function to load a package that you has previously been installed. For example, now that we have installed <code>skimr</code>, we need to load it before we can use it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that quotation marks are not required for the <code>library()</code> function (although they can be included if you really like quotation marks!).</p>
<section id="installing-vs-loading-packages" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="installing-vs-loading-packages">Installing vs loading packages</h4>
<p>Package installation:</p>
<ul>
<li>use the <code>install.packages()</code> function (note the ‘s’) or <strong>Tools &gt; Install packages</strong></li>
<li>the package name must be surrounded by quotation marks</li>
<li>only needs to be done once</li>
</ul>
<p>Package loading</p>
<ul>
<li>use the <code>library()</code> function</li>
<li>the package name does not need to be surrounded by quotation marks</li>
<li>must be done for each R session</li>
</ul>
</section>
</section>
</section>
<section id="what-is-this-thing-called-the-tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="what-is-this-thing-called-the-tidyverse">What is this thing called the tidyverse?</h2>
<p>If you have done much reading about R, you may have come across the tidyverse:</p>
<blockquote class="blockquote">
<p>“The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures.”&nbsp;<a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a></p>
</blockquote>
<p>Packages in the tidyverse have been designed with a goal to make using R more consistent by defining a “grammar” to manipulate data, examine data and draw conclusions from data. While the tidyverse is a common and powerful set of packages, we will not be teaching the tidyverse in this course for two main reasons:</p>
<ol type="1">
<li>The data we provide have been saved in a relatively tidy way, and do not need much manipulation for analyses to be conducted. The cognitive load in learning the tidyverse in this course is greater than the benefit that could be gained.</li>
<li>There are many resources (online, in print etc) that are based on <code>base R</code>, and do not use the tidyverse. It would be difficult to understand these resources if we taught only tidyverse techniques. In particular, the <code>dataframe$variable</code> syntax is an important concept that should be understood before moving into the tidyverse.</li>
</ol>
<p>In saying all of this, I think the tidyverse is an excellent set of packages, which I frequently use. At the completion of this course, you will be well equipped to teach yourself tidyverse using many excellent resources such as: <a href="https://jhudatascience.org/tidyversecourse/">Tidyverse Skills for Data Science</a> and <a href="https://r4ds.had.co.nz/">R for Data Science</a>.</p>
</section>
<section id="part-2-obtaining-basic-descriptive-statistics" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="part-2-obtaining-basic-descriptive-statistics">Part 2: Obtaining basic descriptive statistics</h2>
<p>In this exercise, we will analyse data to complete a descriptive table from a research study. The data come from a study in primary biliary cirrhosis, a condition of the liver, from Modeling Survival Data: Extending the Cox Model <span class="citation" data-cites="therneau_grambsch10">Therneau and Grambsch (<a href="references.html#ref-therneau_grambsch10" role="doc-biblioref">2010</a>)</span>. By the end of this exercise, we will have completed the following table.</p>
<div class="cell">
<div class="cell-output-display">

<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 95%; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-24">
<caption style="caption-side: top; text-align: center;">Summary of 418 participants from the PBC study (Therneau and Grambsch, 2000)</caption><colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Characteristic</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"> </th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Summary</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Age (years)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Mean (SD) or Median [IQR]</td></tr>
<tr>
<td rowspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Sex</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">AST* (U/ml)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Mean (SD) or Median [IQR]</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Serum bilirubin</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Mean (SD) or Median [IQR]</td></tr>
<tr>
<td rowspan="4" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Stage</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">I</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">II</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">III</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">IV</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td rowspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Vital status at study end</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Alive: no transplant</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Alive: transplant</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Deceased</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">n (%)</td></tr>
<tr>
<td colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">* asparate aminotransferase</td></tr>
</tbody></table>

</div>
</div>
<p>This table is available in Table1.docx, saved on Moodle.</p>
</section>
<section id="set-up-your-data" class="level2">
<h2 class="anchored" data-anchor-id="set-up-your-data">Set up your data</h2>
<p>We created a project in the previous step. We will now create a folder to store all the data for this course. Storing the data within the project makes life much easier!</p>
<p>Create a new folder by clicking the <strong>New Folder</strong> icon in the <strong>Files</strong> tab at the bottom-right:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/NewFolder-1.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>Call the new folder <strong>data</strong>.</p>
<p>Click on this folder to open it, and then create two new folders: <strong>activities</strong> and <strong>examples</strong>.</p>
<p>Download the “Data sets: for learning activities” from Moodle, and use Windows Explorer or MacOS Finder to save these data sets in <strong>activities</strong>. Save the “Data sets: example data from course notes” into the <strong>examples</strong> folder.</p>
<p>Your <strong>activities</strong> folder should look like:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/data-folder.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>Click the two dots next to the up-arrow at the top of the folder contents to move back up the folder structure. Note that you need to click the dots, and not the up-facing green arrow!</p>
</section>
<section id="reading-a-data-file" class="level2">
<h2 class="anchored" data-anchor-id="reading-a-data-file">Reading a data file</h2>
<p>Typing data directly into R is not common; we usually read data that have been previously saved. In this example, we will read an <code>.rds</code> file using the <code>readRDS()</code> function, which has only one input: the location of the file.</p>
<p>1 - Confirm that the <code>pbc.rds</code> file is in the <code>activities</code> sub-folder within the <code>data</code> folder (as per the previous steps).</p>
<p>2 - Install the packages: <code>jmv</code>, <code>skimr</code> and <code>summarytools</code> using <strong>Tools &gt; Install packages</strong>, or by typing into the console:</p>
<p><code>install.packages("jmv")</code></p>
<p><code>install.packages("skimr")</code></p>
<p><code>install.packages("summarytools")</code></p>
<p>3 - Load the <code>skimr</code> package, and use the <code>readRDS()</code> function to read the file into R, assigning it to a data frame called <code>pbc</code>. Because we set up our project, we can locate our data easily by telling R to use the file: <code>"data/activities/pbc.rds"</code>, which translates as: the file <code>pbc.rds</code> which is located in the <code>activities</code> sub-folder within the <code>data</code> folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>pbc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/activities/pbc.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>4 - We can now use the <code>summary()</code> function to examine the pbc dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pbc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       id             time          status            trt       
 Min.   :  1.0   Min.   :  41   Min.   :0.0000   Min.   :1.000  
 1st Qu.:105.2   1st Qu.:1093   1st Qu.:0.0000   1st Qu.:1.000  
 Median :209.5   Median :1730   Median :0.0000   Median :1.000  
 Mean   :209.5   Mean   :1918   Mean   :0.8301   Mean   :1.494  
 3rd Qu.:313.8   3rd Qu.:2614   3rd Qu.:2.0000   3rd Qu.:2.000  
 Max.   :418.0   Max.   :4795   Max.   :2.0000   Max.   :2.000  
                                                 NA's   :106    
      age             sex           ascites            hepato      
 Min.   :26.28   Min.   :1.000   Min.   :0.00000   Min.   :0.0000  
 1st Qu.:42.83   1st Qu.:2.000   1st Qu.:0.00000   1st Qu.:0.0000  
 Median :51.00   Median :2.000   Median :0.00000   Median :1.0000  
 Mean   :50.74   Mean   :1.895   Mean   :0.07692   Mean   :0.5128  
 3rd Qu.:58.24   3rd Qu.:2.000   3rd Qu.:0.00000   3rd Qu.:1.0000  
 Max.   :78.44   Max.   :2.000   Max.   :1.00000   Max.   :1.0000  
                                 NA's   :106       NA's   :106     
    spiders           edema             bili             chol       
 Min.   :0.0000   Min.   :0.0000   Min.   : 0.300   Min.   : 120.0  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.: 0.800   1st Qu.: 249.5  
 Median :0.0000   Median :0.0000   Median : 1.400   Median : 309.5  
 Mean   :0.2885   Mean   :0.1005   Mean   : 3.221   Mean   : 369.5  
 3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.: 3.400   3rd Qu.: 400.0  
 Max.   :1.0000   Max.   :1.0000   Max.   :28.000   Max.   :1775.0  
 NA's   :106                                        NA's   :134     
    albumin          copper          alkphos             ast        
 Min.   :1.960   Min.   :  4.00   Min.   :  289.0   Min.   : 26.35  
 1st Qu.:3.243   1st Qu.: 41.25   1st Qu.:  871.5   1st Qu.: 80.60  
 Median :3.530   Median : 73.00   Median : 1259.0   Median :114.70  
 Mean   :3.497   Mean   : 97.65   Mean   : 1982.7   Mean   :122.56  
 3rd Qu.:3.770   3rd Qu.:123.00   3rd Qu.: 1980.0   3rd Qu.:151.90  
 Max.   :4.640   Max.   :588.00   Max.   :13862.4   Max.   :457.25  
                 NA's   :108      NA's   :106       NA's   :106     
      trig           platelet        protime          stage      
 Min.   : 33.00   Min.   : 62.0   Min.   : 9.00   Min.   :1.000  
 1st Qu.: 84.25   1st Qu.:188.5   1st Qu.:10.00   1st Qu.:2.000  
 Median :108.00   Median :251.0   Median :10.60   Median :3.000  
 Mean   :124.70   Mean   :257.0   Mean   :10.73   Mean   :3.024  
 3rd Qu.:151.00   3rd Qu.:318.0   3rd Qu.:11.10   3rd Qu.:4.000  
 Max.   :598.00   Max.   :721.0   Max.   :18.00   Max.   :4.000  
 NA's   :136      NA's   :11      NA's   :2       NA's   :6      </code></pre>
</div>
</div>
<p>An alternative to the <code>summary()</code> function is the <code>skim()</code> function in the <code>skimr</code> package, which produces summary statistics as well as rudimentary histograms:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(pbc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="img/mod01/skim-pbc.png" class="img-fluid" style="width:90.0%"></p>
</div>
</div>
<p>The <code>summary()</code> and <code>skim()</code> functions are useful to give a quick overview of a dataset: how many variables are included, how variables are coded, which variables contain missing data and a crude histogram showing the distribution of numeric variables.</p>
</section>
<section id="summarising-continuous-variables" class="level2">
<h2 class="anchored" data-anchor-id="summarising-continuous-variables">Summarising continuous variables</h2>
<p>One of the most flexible functions for summarising continuous variables is the <code>descriptives()</code> function from the <code>jmv</code> package. The function is specified as <code>descriptives(data=, vars=)</code> where:</p>
<ul>
<li><code>data</code> specifies the dataframe to be analysed</li>
<li><code>vars</code> specifies the variable(s) of interest, with multiple variables combined using the <code>c()</code> function</li>
</ul>
<p>We can summarise the three continuous variables in the pbc data: age, AST and serum bilirubin, as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jmv)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>pbc, <span class="at">vars=</span><span class="fu">c</span>(age, ast, bili))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 DESCRIPTIVES

 Descriptives                                                
 ─────────────────────────────────────────────────────────── 
                         age         ast         bili        
 ─────────────────────────────────────────────────────────── 
   N                          418         312          418   
   Missing                      0         106            0   
   Mean                  50.74155    122.5563     3.220813   
   Median                51.00068    114.7000     1.400000   
   Standard deviation    10.44721    56.69952     4.407506   
   Minimum               26.27789    26.35000    0.3000000   
   Maximum               78.43943    457.2500     28.00000   
 ─────────────────────────────────────────────────────────── </code></pre>
</div>
</div>
<p>By default, the <code>descriptives</code> function presents the mean, median, standard deviation, minimum and maximum. We can request additional statistics, such as the quartiles (which are called the percentiles, or pc, in the descriptives function):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>pbc, <span class="at">vars=</span><span class="fu">c</span>(age, ast, bili), <span class="at">pc=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 DESCRIPTIVES

 Descriptives                                                
 ─────────────────────────────────────────────────────────── 
                         age         ast         bili        
 ─────────────────────────────────────────────────────────── 
   N                          418         312          418   
   Missing                      0         106            0   
   Mean                  50.74155    122.5563     3.220813   
   Median                51.00068    114.7000     1.400000   
   Standard deviation    10.44721    56.69952     4.407506   
   Minimum               26.27789    26.35000    0.3000000   
   Maximum               78.43943    457.2500     28.00000   
   25th percentile       42.83231    80.60000    0.8000000   
   50th percentile       51.00068    114.7000     1.400000   
   75th percentile       58.24093    151.9000     3.400000   
 ─────────────────────────────────────────────────────────── </code></pre>
</div>
</div>
</section>
<section id="producing-a-histogram" class="level2">
<h2 class="anchored" data-anchor-id="producing-a-histogram">Producing a histogram</h2>
<p>We can use the <code>hist()</code> function to produce a histogram, specifying the dataframe to use and the variable to be plotted as <code>dataframe$variable</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pbc<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The histogram function does a remarkably good job of choosing cutpoints and binwidths, and these rarely need to be changed. However, the labelling of the histogram should be improved by using <code>xlab=" "</code> and <code>main=" "</code> to assign labels for the x-axis and overall title respectively:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pbc<span class="sc">$</span>age, <span class="at">xlab=</span><span class="st">"Age (years)"</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Histogram of participant age from pbc study data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By default, the <code>hist()</code> function plots a <strong>frequency histogram</strong>, with counts on the y-axis. We can tweak the histogram using the following code to plot a histogram of the <strong>relative frequencies</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">hist</span>(pbc<span class="sc">$</span>age, <span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>h<span class="sc">$</span>density <span class="ot">&lt;-</span> h<span class="sc">$</span>counts<span class="sc">/</span><span class="fu">sum</span>(h<span class="sc">$</span>counts)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h, <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Age (years)"</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Relative frequency (%)"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Histogram of participant age from pbc study data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="producing-a-boxplot" class="level2">
<h2 class="anchored" data-anchor-id="producing-a-boxplot">Producing a boxplot</h2>
<p>The <code>boxplot</code> function is used to produce boxplots, again specifying the dataframe to use and the variable to be plotted as <code>dataframe$variable</code>. Labels can be applied in the same way as the histogram:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(pbc<span class="sc">$</span>age, <span class="at">xlab=</span><span class="st">"Age (years)"</span>, <span class="at">main=</span><span class="st">"Boxplot of participant age from pbc study data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="producing-a-one-way-frequency-table" class="level2">
<h2 class="anchored" data-anchor-id="producing-a-one-way-frequency-table">Producing a one-way frequency table</h2>
<p>We have three categorical variables to summarise in Table 1: sex, stage and vital status. These variables are best summarised using one-way frequency tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(pbc<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies  
pbc$sex  
Type: Numeric  

              Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
----------- ------ --------- -------------- --------- --------------
          1     44     10.53          10.53     10.53          10.53
          2    374     89.47         100.00     89.47         100.00
       &lt;NA&gt;      0                               0.00         100.00
      Total    418    100.00         100.00    100.00         100.00</code></pre>
</div>
</div>
<section id="defining-categorical-variables-as-factors" class="level3">
<h3 class="anchored" data-anchor-id="defining-categorical-variables-as-factors">Defining categorical variables as factors</h3>
<p>You will notice that the table above, in its current form, is uninterpretable as the 1 and 2 categories are not labelled. In this course, all variables including categorical variables tend to be numerically coded. To define a categorical variable as such in R, we define it as a <strong>factor</strong> using the factor function:</p>
<p><code>factor(variable=, levels=, labels=)</code></p>
<p>We specify:</p>
<ul>
<li>levels: the values the categorical variable can take</li>
<li>labels: the labels corresponding to each of the levels (entered in the same order as the levels)</li>
</ul>
<p>To define our variable sex as a factor, we use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pbc<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(pbc<span class="sc">$</span>sex, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can confirm the coding by re-running a frequency table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(pbc<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies  
pbc$sex  
Type: Factor  

               Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
------------ ------ --------- -------------- --------- --------------
        Male     44     10.53          10.53     10.53          10.53
      Female    374     89.47         100.00     89.47         100.00
        &lt;NA&gt;      0                               0.00         100.00
       Total    418    100.00         100.00    100.00         100.00</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Task: define <code>stage</code> and <code>status</code> (Vital Status) as factors, and produce one-way frequency tables. Refer to the file <code>pbc_info.txt</code> to view the labels for each variable. For example, for Stage:</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pbc<span class="sc">$</span>stage <span class="ot">&lt;-</span> <span class="fu">factor</span>(pbc<span class="sc">$</span>stage, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Stage 1"</span>, <span class="st">"Stage 2"</span>, <span class="st">"Stage 3"</span>, <span class="st">"Stage 4"</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(pbc<span class="sc">$</span>stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frequencies  
pbc$stage  
Type: Factor  

                Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
------------- ------ --------- -------------- --------- --------------
      Stage 1     21      5.10           5.10      5.02           5.02
      Stage 2     92     22.33          27.43     22.01          27.03
      Stage 3    155     37.62          65.05     37.08          64.11
      Stage 4    144     34.95         100.00     34.45          98.56
         &lt;NA&gt;      6                               1.44         100.00
        Total    418    100.00         100.00    100.00         100.00</code></pre>
</div>
</div>
</section>
</section>
<section id="producing-a-two-way-frequency-table" class="level2">
<h2 class="anchored" data-anchor-id="producing-a-two-way-frequency-table">Producing a two-way frequency table</h2>
<p>To produce tables summarising two categorical variables, we can use the <code>contTables()</code> function within the <code>jmv</code> package. The minimal inputs to include are <code>data</code>: the name of the data frame to be analysed, <code>rows</code>: the variable representing the rows of the table, and <code>cols</code>: the name of the columns of the table.</p>
<p>For example, to produce a two-way table showing stage of disease by sex using the pbc data frame, we use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contTables</span>(<span class="at">data=</span>pbc, <span class="at">rows=</span>sex, <span class="at">cols=</span>stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 CONTINGENCY TABLES

 Contingency Tables                                              
 ─────────────────────────────────────────────────────────────── 
   sex       Stage 1    Stage 2    Stage 3    Stage 4    Total   
 ─────────────────────────────────────────────────────────────── 
   Male            3          8         16         17       44   
   Female         18         84        139        127      368   
   Total          21         92        155        144      412   
 ─────────────────────────────────────────────────────────────── 


 χ² Tests                               
 ────────────────────────────────────── 
         Value        df    p           
 ────────────────────────────────────── 
   χ²    0.8779873     3    0.8307365   
   N           412                      
 ────────────────────────────────────── </code></pre>
</div>
</div>
<p>[The bottom part of the output, χ² Tests, can be ignored for now]</p>
<p>You may notice in the above that the number of observations is now 412. This is because there are missing observations for either sex or stage: which is it, and how would you determine this?</p>
<p>From the cross-tabulation, you can see the individual frequencies of participants in each of the categories in each cell. For example, there are 3 male participants who have Stage 1 disease. You can also read the totals for each row and column. For example, there are 44 males, and 144 participants have Stage 4 disease.</p>
<p>You can also add percentages into your table using <code>pcCol=TRUE</code> to include column percents, and <code>pcRow=TRUE</code> for row percents. For example, to calculate the relative frequencies (i.e.&nbsp;percentages) of sex within each stage, we would request <strong>column percents</strong> with the option: <code>pcCol=TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contTables</span>(<span class="at">data=</span>pbc, <span class="at">rows=</span>sex, <span class="at">cols=</span>stage, <span class="at">pcCol=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 CONTINGENCY TABLES

 Contingency Tables                                                                             
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   sex                          Stage 1      Stage 2      Stage 3      Stage 4      Total       
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   Male      Observed                   3            8           16           17           44   
             % within column     14.28571      8.69565     10.32258     11.80556     10.67961   
                                                                                                
   Female    Observed                  18           84          139          127          368   
             % within column     85.71429     91.30435     89.67742     88.19444     89.32039   
                                                                                                
   Total     Observed                  21           92          155          144          412   
             % within column    100.00000    100.00000    100.00000    100.00000    100.00000   
 ────────────────────────────────────────────────────────────────────────────────────────────── 


 χ² Tests                               
 ────────────────────────────────────── 
         Value        df    p           
 ────────────────────────────────────── 
   χ²    0.8779873     3    0.8307365   
   N           412                      
 ────────────────────────────────────── </code></pre>
</div>
</div>
<p>We can see that the 3 male participants with Stage 1 disease represent 14% of those with Stage 1 disease.</p>
</section>
<section id="saving-data-in-r" class="level2">
<h2 class="anchored" data-anchor-id="saving-data-in-r">Saving data in R</h2>
<p>There are many ways to save data from R, depending on the type of file you want to save. The recommendation for this course is to save your data using the <code>.rds</code> format, using the <code>saveRDS()</code> function, which takes two inputs: <code>saveRDS(object, file)</code>. Here, <code>object</code> is the R object to be saved (usually a data frame), and <code>file</code> is the location for the file to be saved (file name and path, including the <code>.rds</code> suffix).</p>
<p>It is not necessary to save our PBC data, as we have made only minor changes to the data that can be replicated by rerunning our script. If you had made major changes and wanted to save your data, you could use:</p>
<p><code>saveRDS(pbc, file="pbc_revised.rds")</code></p>
</section>
<section id="copying-output-from-r" class="level2">
<h2 class="anchored" data-anchor-id="copying-output-from-r">Copying output from R</h2>
<p>It is important to note that saving your data or your script in R will not save your output. The easiest way to retain the output of your analyses is to copy the output from the Console into a word processor package (e.g.&nbsp;Microsoft Word) before closing R.</p>
<p>Unfortunately, by default, R is not ideal for creating publication quality tables. There are many packages that will help in this process, such as R Markdown, bookdown<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, huxtable, gt and gtsummary, but their use is beyond the scope of this course. <a href="https://rmd4sci.njtierney.com/">R Markdown for Scientists</a> provides an excellent introduction to R Markdown.</p>
<blockquote class="blockquote">
<p>Task: Complete Table 1 using the output generated in this exercise. You should decide on whether to present continuous variables by their means or medians, and present the most appropriate measure of spread. Include footnotes to indicate if any variables contain missing observations.</p>
</blockquote>
</section>
<section id="part-3-creating-other-types-of-graphs" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="part-3-creating-other-types-of-graphs">Part 3: Creating other types of graphs</h2>
<p>The <code>plot()</code> function, also known as <em>base graphics</em>, is the default method of plotting data in R that can produce publication-quality graphics with minimal coding. There are alternative packages for plotting, with <code>ggplot2</code> being one of the most well known. We will present instructions for base graphics in this course, but excellent documentation for <code>ggplot2</code> can be found at the <a href="https://ggplot2-book.org/">ggplot2: Elegant Graphics for Data Analysis</a> website, written by the package authors.</p>
</section>
<section id="bar-graphs" class="level2">
<h2 class="anchored" data-anchor-id="bar-graphs">Bar graphs</h2>
<p>The simplest way to use the <code>plot()</code> function is by specifying an object to be plotted. As with the <code>hist()</code> function, to plot a single variable from a data frame, we must define it using: <code>dataframe$variable</code>.</p>
<p>Here we will create the bar chart shown in Figure 1.3 of the statistics notes using the <code>pbc.rds</code> dataset. The x-axis of this graph will be the stage of disease, and the y-axis will show the number of participants in each category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pbc<span class="sc">$</span>stage, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Bar graph of stage of disease from PBC study"</span>, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Number of participants"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that stage is a categorical variable, that has been defined as a factor (in Section @ref(defining-categorical-variables-as-factors)). You <strong>must define categorical data as factors</strong> to plot them in a bar graph.</p>
<section id="clustered-bar-graph" class="level3">
<h3 class="anchored" data-anchor-id="clustered-bar-graph">Clustered bar graph</h3>
<p>To create a clustered bar chart as shown in Figure 1.4 of the statistics notes, we need to do a bit of manipulation. We first need to tabulate the data using the <code>table()</code> function. We want to plot stage of disease broken down by sex, so we specify <code>sex</code> as the first variable, and <code>stage</code> as the second variable for the <code>table()</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">table</span>(pbc<span class="sc">$</span>sex, pbc<span class="sc">$</span>stage)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         Stage 1 Stage 2 Stage 3 Stage 4
  Male         3       8      16      17
  Female      18      84     139     127</code></pre>
</div>
</div>
<p>After tabulating the data, we use the <code>barplot()</code> function to plot the summarised data. We specify the main title using <code>main=" "</code>, specify that the stages be plotted separately by sex (<code>beside=TRUE</code>), specify the legend be defined by sex, and position the legend in the top-left of the graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(counts, <span class="at">main=</span><span class="st">"Bar graph of stage of disease by sex from PBC study"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">beside=</span><span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="fu">rownames</span>(counts), <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">"topleft"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stacked-bar-graph" class="level3">
<h3 class="anchored" data-anchor-id="stacked-bar-graph">Stacked bar graph</h3>
<p>A stacked bar graph can be constructed as for the clustered bar graph, but we specify <code>beside=FALSE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(counts, <span class="at">main=</span><span class="st">"Bar graph of stage of disease by sex from PBC study"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">beside=</span><span class="cn">FALSE</span>, <span class="at">legend =</span> <span class="fu">rownames</span>(counts), <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">"topleft"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stacked-bar-graph-of-relative-frequencies" class="level3">
<h3 class="anchored" data-anchor-id="stacked-bar-graph-of-relative-frequencies">Stacked bar graph of relative frequencies</h3>
<p>To plot relative frequencies, we need to transform our table of frequencies (<code>counts</code>) into proportions, by using the <code>prop.table()</code> function. The prop.table() function takes two arguments: a table of counts, and <code>margin</code>, which defines whether we want proportions calculated by row (<code>margin=1</code>) or column (<code>margin=2</code>).</p>
<p>We want to calculate the relative frequency of sex within each stage category. From our <code>counts</code> table above, this equates to calculating <em>column</em> proportions, so we specify <code>margin=2</code>. We also multiply the resulting table by 100 to obtain percentages (rather than proportions):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(counts, <span class="at">margin=</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
           Stage 1   Stage 2   Stage 3   Stage 4
  Male   14.285714  8.695652 10.322581 11.805556
  Female 85.714286 91.304348 89.677419 88.194444</code></pre>
</div>
</div>
<p>After calculating the percentages, we use <code>barplot()</code> again, similar to the stacked bar graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(percent, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Relative frequency of sex within stage of disease from PBC study"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="fu">rownames</span>(counts), <span class="at">beside=</span><span class="cn">FALSE</span>, <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">"topright"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="creating-line-graphs" class="level2">
<h2 class="anchored" data-anchor-id="creating-line-graphs">Creating line graphs</h2>
<p>To demonstrate the graphing of aggregate data , we use the data on new cases and deaths from prostate cancer in males in NSW. This data has been entered as <code>Example_1.2.rds</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>cancer <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/examples/Example_1.2.rds"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      year          ncases        ndeaths           rcases         rdeaths     
 Min.   :1987   Min.   :1567   Min.   : 645.0   Min.   : 81.8   Min.   :31.10  
 1st Qu.:1992   1st Qu.:2804   1st Qu.: 788.2   1st Qu.:121.9   1st Qu.:34.67  
 Median :1996   Median :3790   Median : 868.0   Median :131.3   Median :36.55  
 Mean   :1996   Mean   :3719   Mean   : 855.0   Mean   :135.4   Mean   :37.09  
 3rd Qu.:2001   3rd Qu.:4403   3rd Qu.: 921.0   3rd Qu.:164.2   3rd Qu.:40.38  
 Max.   :2006   Max.   :6158   Max.   :1044.0   Max.   :186.9   Max.   :43.80  </code></pre>
</div>
</div>
<p>We begin by plotting cancer cases (as the <em>y</em> variable) against year (the <em>x</em> variable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>cancer<span class="sc">$</span>year, <span class="at">y=</span>cancer<span class="sc">$</span>rcases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s define the plot to be joined by lines (<code>type="l"</code>), in the colour red (<code>col="red"</code>), providing meaningful labels for the x-axis and y-axis, and changing the scale of the y-axis to be between 0 and 200 (<code>ylim=c(0,200)</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>cancer<span class="sc">$</span>year, <span class="at">y=</span>cancer<span class="sc">$</span>rcases, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Year"</span>, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Age-standardised rate (per 100,000)"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can now add a second line to the plot using the <code>lines()</code> function, specifying a dashed line (<code>lty=2</code>), and add a legend to the plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>cancer<span class="sc">$</span>year, <span class="at">y=</span>cancer<span class="sc">$</span>rcases, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span>, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Age-standardised rate (per 100,000)"</span>, </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cancer<span class="sc">$</span>year, cancer<span class="sc">$</span>rdeaths, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Incidence"</span>, <span class="st">"Deaths"</span>), </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="01.2-intro-R_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note: coding for graphs is not always straightforward. Two excellent resources for creating graphs in R are: <a href="https://r-graphics.org/">R Graphics Cookbook</a> and <a href="https://r-graph-gallery.com/">The R Graph Gallery</a>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-therneau_grambsch10" class="csl-entry" role="doc-biblioentry">
Therneau, Terry M., and Patricia M. Grambsch. 2010. <em>Modeling <span>Survival Data</span>: <span>Extending</span> the <span>Cox Model</span></em>. <span>New York Berlin Heidelberg</span>: <span>Springer</span>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>these R notes and the PHCM9795 course notes have been written using <a href="https://bookdown.org/yihui/bookdown/">bookdown</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01.1-intro-stata.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><strong>1</strong> An introduction to Stata</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01.3-intro-activities.html" class="pagination-link">
        <span class="nav-page-text"><strong>1</strong> Learning Activities</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>